const axios =  require('axios').default

const fazerBusca = async (req, res) => {
    
    
    try {
        const {genero} = req.params
        console.log('rodei');
        console.log(genero);
        const {data} = await axios.get(           
           `http://openlibrary.org/subjects/${genero}.json`
        );
        const x = 6
               


        const result = {
            título: data.works[x].title,
            autor: data.works[x].authors[0].name,
            primeira_publicação: data.works[x].first_publish_year,
            capa: {
                id_capa: data.works[x].cover_id,
                key_cover: data.works[x].cover_edition_key //OLID
            }
        }
        return res.status(200).json(result);
    } catch (error) {  
        console.log('deu ruim');      
        return res.status(400).json(error)
    }
}

module.exports = fazerBusca